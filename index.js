var A=Object.defineProperty;var V=(w,e,t)=>e in w?A(w,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):w[e]=t;var n=(w,e,t)=>(V(w,typeof e!="symbol"?e+"":e,t),t);import{W as R,S as x,P as z,C as E,V as F,M as I,D as W,L as B,G,A as U,a as X,b as p,c as K,B as N,d as b,e as T,f as _,g as H,T as j,h as q,F as O,i as P}from"./vendor.js";const $=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))c(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}};$();class J{constructor(e=1.333){n(this,"aspectRatio");n(this,"fov");n(this,"znear");n(this,"zfar");n(this,"renderer");n(this,"scene");n(this,"camera");n(this,"clock");this.aspectRatio=e,this.fov=60,this.znear=1,this.zfar=1e3,this.renderer=new R,this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),this.resize(),window.addEventListener("resize",()=>{this.resize()},!1),window.addEventListener("mousedown",t=>{this.onMouseDown(t)}),window.addEventListener("mouseup",t=>{this.onMouseUp(t)}),window.addEventListener("mousemove",t=>{this.onMouseMove(t)}),window.addEventListener("keydown",t=>{this.onKeyDown(t)}),window.addEventListener("keyup",t=>{this.onKeyUp(t)}),this.scene=new x,this.camera=new z(this.fov,this.aspectRatio,this.znear,this.zfar),this.clock=new E}start(){this.createScene(),this.mainLoop()}mainLoop(){this.update(this.clock.getDelta()),this.renderer.render(this.scene,this.camera),window.requestAnimationFrame(()=>this.mainLoop())}resize(){this.renderer.setSize(window.innerWidth,window.innerHeight);var e=new F;this.renderer.getViewport(e);var t=window.innerWidth/window.innerHeight;this.aspectRatio>t?this.renderer.setViewport(0,(window.innerHeight-window.innerWidth/this.aspectRatio)/2,window.innerWidth,window.innerWidth/this.aspectRatio):this.renderer.setViewport((window.innerWidth-window.innerHeight*this.aspectRatio)/2,0,window.innerHeight*this.aspectRatio,window.innerHeight)}onMouseDown(e){}onMouseUp(e){}onMouseMove(e){}onKeyDown(e){}onKeyUp(e){}}class Q extends J{constructor(){super(1920/1080);n(this,"debugMode");n(this,"mouseDrag");n(this,"cameraOrbitX");n(this,"cameraOrbitY");n(this,"cameraDistance");n(this,"lightOrbitX");n(this,"lightOrbitY");n(this,"lightIntensity");n(this,"debugMaterial");n(this,"light");n(this,"lightHelper");n(this,"cylinder");n(this,"cylinderVertices");n(this,"crushedCylinderVertices");this.debugMode=!1,this.mouseDrag=!1,this.cameraOrbitX=0,this.cameraOrbitY=0,this.cameraDistance=0,this.lightOrbitX=0,this.lightOrbitY=0,this.lightIntensity=0,this.debugMaterial=new I,this.light=new W,this.lightHelper=new B,this.cylinder=new G,this.cylinderVertices=[],this.crushedCylinderVertices=[]}createScene(){this.cameraDistance=4,this.camera.position.set(0,0,this.cameraDistance),this.camera.lookAt(0,0,0),this.camera.up.set(0,1,0);var e=new U("white",.3);this.scene.add(e),this.light.color=new X("white"),this.lightIntensity=1,this.lightOrbitX=-22.5,this.lightOrbitY=45,this.scene.add(this.light);var t=[];t.push(new p(0,0,0)),t.push(new p(0,0,10)),this.lightHelper.geometry.setFromPoints(t),this.scene.add(this.lightHelper);var c=new K;c.color=new X("gray"),this.lightHelper.material=c,this.updateLightParameters();var i=new I;i.side=N,i.color.set("black");var s=new b(new T(1e3,1e3,1e3),i);this.scene.add(s),this.debugMaterial.wireframe=!0;var d=new _(2);this.scene.add(d);const a=10,h=10,r=2.5;var o=this.createCrushableCylinderMesh(a,h,r);this.cylinder.add(o);var v=new H;v.map=new j().load("./assets/campbells.png"),o.material=v;const M=.05;var m=this.createCylinderMesh(a,M);m.position.set(0,r/2+M/2,0),this.cylinder.add(m);var l=m.clone();l.position.set(0,-r/2+-M/2,0),l.scale.set(1,-1,1),this.cylinder.add(l);var u=this.createDiscMesh(a);u.position.set(0,r/2+M,0),this.cylinder.add(u);var L=u.clone();L.position.set(0,-r/2,0),L.scale.set(1,-1,1),this.cylinder.add(L);var y=new H;y.color.set(new X(.4,.4,.4)),m.material=y,l.material=y,u.material=y,L.material=y,this.scene.add(this.cylinder);var k=new q,g=k.addFolder("Controls");g.open();var D=g.add(this,"lightOrbitX",-180,180);D.name("Light Orbit X"),D.onChange(C=>{this.updateLightParameters()});var f=g.add(this,"lightOrbitY",-90,90);f.name("Light Orbit Y"),f.onChange(C=>{this.updateLightParameters()});var f=g.add(this,"lightIntensity",0,2);f.name("Light Intensity"),f.onChange(C=>{this.updateLightParameters()});var Y=g.add(this,"debugMode");Y.name("Debug Mode"),Y.onChange(C=>{this.toggleDebugMode(C)})}createCrushableCylinderMesh(e,t,c){var i=[],s=[],d=[],a=360/e*Math.PI/180,h=c/t;for(let l=0;l<=t;l++)for(let u=0;u<=e;u++){var r=u*a,o=-c/2+l*h;this.cylinderVertices.push(new p(Math.cos(r),o,Math.sin(r))),this.cylinderVertices.push(new p(Math.cos(r+a),o,Math.sin(r+a))),this.crushedCylinderVertices.push(new p(Math.cos(r),o,Math.sin(r))),this.crushedCylinderVertices.push(new p(Math.cos(r+a),o,Math.sin(r+a))),i.push(Math.cos(r),0,Math.sin(r)),i.push(Math.cos(r+a),0,Math.sin(r+a)),s.push(1-u/e,l/t),s.push(1-(u+1)/e,l/t)}for(let l=0;l<=t;l++)for(let u=0;u<=e;u++){var v=(l*e+u)*2,M=v+e*2;d.push(v,M+1,v+1),d.push(v,M,M+1)}var m=new b;return m.geometry.setFromPoints(this.crushedCylinderVertices),m.geometry.setIndex(d),m.geometry.setAttribute("normal",new O(i,3)),m.geometry.setAttribute("uv",new O(s,2)),m}createCylinderMesh(e,t){var c=[],i=[],s=[],d=[],a=360/e*Math.PI/180;for(let o=0;o<e;o++){var h=o*a;c.push(new p(Math.cos(h),t/2,Math.sin(h))),c.push(new p(Math.cos(h),-t/2,Math.sin(h))),c.push(new p(Math.cos(h+a),t/2,Math.sin(h+a))),c.push(new p(Math.cos(h+a),-t/2,Math.sin(h+a))),i.push(Math.cos(h),0,Math.sin(h)),i.push(Math.cos(h),0,Math.sin(h)),i.push(Math.cos(h+a),0,Math.sin(h+a)),i.push(Math.cos(h+a),0,Math.sin(h+a)),s.push(1-o/e,1),s.push(1-o/e,0),s.push(1-(o+1)/e,1),s.push(1-(o+1)/e,0),d.push(o*4,o*4+2,o*4+1),d.push(o*4+1,o*4+2,o*4+3)}var r=new b;return r.geometry.setFromPoints(c),r.geometry.setIndex(d),r.geometry.setAttribute("normal",new O(i,3)),r.geometry.setAttribute("uv",new O(s,2)),r}createDiscMesh(e){var h=new b,t=[],c=[],i=[];t.push(new p(0,0,0)),c.push(0,1,0);var s=360/e*Math.PI/180,d=2*Math.PI/s;for(let r=0;r<d;r++){var a=r*s;t.push(new p(Math.cos(a),0,Math.sin(a))),t.push(new p(Math.cos(a+s),0,Math.sin(a+s))),c.push(0,1,0),c.push(0,1,0),i.push(0,r*2+2,r*2+1)}var h=new b;return h.geometry.setFromPoints(t),h.geometry.setIndex(i),h.geometry.setAttribute("normal",new O(c,3)),h}update(e){}onMouseDown(e){e.target.localName=="canvas"&&(this.mouseDrag=!0)}onMouseUp(e){this.mouseDrag=!1}onMouseMove(e){this.mouseDrag&&(this.cameraOrbitX+=e.movementY,this.cameraOrbitX<90||this.cameraOrbitX>270?this.cameraOrbitY+=e.movementX:this.cameraOrbitY-=e.movementX,this.cameraOrbitX>=360?this.cameraOrbitX-=360:this.cameraOrbitX<0&&(this.cameraOrbitX+=360),this.cameraOrbitY>=360?this.cameraOrbitY-=360:this.cameraOrbitY<0&&(this.cameraOrbitY+=360),this.updateCameraOrbit())}updateCameraOrbit(){var e=new P().makeRotationY(-this.cameraOrbitY*Math.PI/180);e.multiply(new P().makeRotationX(-this.cameraOrbitX*Math.PI/180)),this.camera.position.set(0,0,this.cameraDistance),this.camera.applyMatrix4(e),this.cameraOrbitX<90||this.cameraOrbitX>270?this.camera.up.set(0,1,0):this.cameraOrbitX>90&&this.cameraOrbitX<270?this.camera.up.set(0,-1,0):this.cameraOrbitX==270?this.camera.up.set(Math.sin(-this.cameraOrbitY*Math.PI/180),0,Math.cos(-this.cameraOrbitY*Math.PI/180)):this.camera.up.set(-Math.sin(-this.cameraOrbitY*Math.PI/180),0,-Math.cos(-this.cameraOrbitY*Math.PI/180)),this.camera.lookAt(0,0,0)}updateLightParameters(){var e=new P().makeRotationY(this.lightOrbitX*Math.PI/180);e.multiply(new P().makeRotationX(-this.lightOrbitY*Math.PI/180)),this.light.position.set(0,0,10),this.light.applyMatrix4(e),this.lightHelper.lookAt(this.light.position),this.light.intensity=this.lightIntensity}toggleDebugMode(e){this.cylinder.children.forEach(t=>{t instanceof b&&(e?(t.userData={originalMaterial:t.material},t.material=this.debugMaterial):t.material=t.userData.originalMaterial)})}}var Z=new Q;Z.start();
