var H=Object.defineProperty;var k=(b,e,t)=>e in b?H(b,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):b[e]=t;var h=(b,e,t)=>(k(b,typeof e!="symbol"?e+"":e,t),t);import{W as R,S as x,P as z,C as F,V as E,M as V,D as W,L as U,G as B,a as f,A as G,b as X,c as p,d as K,B as N,e as T,f as _,g as I,T as j,h as q,i as $,F as L,j as P}from"./vendor.js";const J=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}};J();class Q{constructor(e=1.333){h(this,"aspectRatio");h(this,"fov");h(this,"znear");h(this,"zfar");h(this,"renderer");h(this,"scene");h(this,"camera");h(this,"clock");this.aspectRatio=e,this.fov=60,this.znear=1,this.zfar=1e3,this.renderer=new R,this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),this.resize(),window.addEventListener("resize",()=>{this.resize()},!1),window.addEventListener("mousedown",t=>{this.onMouseDown(t)}),window.addEventListener("mouseup",t=>{this.onMouseUp(t)}),window.addEventListener("mousemove",t=>{this.onMouseMove(t)}),window.addEventListener("keydown",t=>{this.onKeyDown(t)}),window.addEventListener("keyup",t=>{this.onKeyUp(t)}),this.scene=new x,this.camera=new z(this.fov,this.aspectRatio,this.znear,this.zfar),this.clock=new F}start(){this.createScene(),this.mainLoop()}mainLoop(){this.update(this.clock.getDelta()),this.renderer.render(this.scene,this.camera),window.requestAnimationFrame(()=>this.mainLoop())}resize(){this.renderer.setSize(window.innerWidth,window.innerHeight);var e=new E;this.renderer.getViewport(e);var t=window.innerWidth/window.innerHeight;this.aspectRatio>t?this.renderer.setViewport(0,(window.innerHeight-window.innerWidth/this.aspectRatio)/2,window.innerWidth,window.innerWidth/this.aspectRatio):this.renderer.setViewport((window.innerWidth-window.innerHeight*this.aspectRatio)/2,0,window.innerHeight*this.aspectRatio,window.innerHeight)}onMouseDown(e){}onMouseUp(e){}onMouseMove(e){}onKeyDown(e){}onKeyUp(e){}}class Z extends Q{constructor(){super(1920/1080);h(this,"debugMode");h(this,"mouseDrag");h(this,"crushAlpha");h(this,"cameraOrbitX");h(this,"cameraOrbitY");h(this,"cameraDistance");h(this,"lightOrbitX");h(this,"lightOrbitY");h(this,"lightIntensity");h(this,"debugMaterial");h(this,"light");h(this,"lightHelper");h(this,"cylinder");h(this,"cylinderMesh");h(this,"cylinderVertices");h(this,"crushedCylinderVertices");this.debugMode=!1,this.mouseDrag=!1,this.crushAlpha=0,this.cameraOrbitX=0,this.cameraOrbitY=0,this.cameraDistance=0,this.lightOrbitX=0,this.lightOrbitY=0,this.lightIntensity=0,this.debugMaterial=new V,this.light=new W,this.lightHelper=new U,this.cylinder=new B,this.cylinderMesh=new f,this.cylinderVertices=[],this.crushedCylinderVertices=[]}createScene(){this.cameraDistance=4,this.camera.position.set(0,0,this.cameraDistance),this.camera.lookAt(0,0,0),this.camera.up.set(0,1,0);var e=new G("white",.3);this.scene.add(e),this.light.color=new X("white"),this.lightIntensity=1,this.lightOrbitX=-22.5,this.lightOrbitY=45,this.scene.add(this.light);var t=[];t.push(new p(0,0,0)),t.push(new p(0,0,10)),this.lightHelper.geometry.setFromPoints(t),this.scene.add(this.lightHelper);var o=new K;o.color=new X("gray"),this.lightHelper.material=o,this.updateLightParameters();var i=new V;i.side=N,i.color.set("black");var r=new f(new T(1e3,1e3,1e3),i);this.scene.add(r),this.debugMaterial.wireframe=!0;var d=new _(2);this.scene.add(d);const n=10,s=10,a=2.5;this.cylinderMesh=this.createCrushableCylinderMesh(n,s,a),this.cylinder.add(this.cylinderMesh);var c=new I;c.map=new j().load("./assets/campbells.png"),this.cylinderMesh.material=c;const M=.05;var v=this.createCylinderMesh(n,M);v.position.set(0,a/2+M/2,0),this.cylinder.add(v);var m=v.clone();m.position.set(0,-a/2+-M/2,0),m.scale.set(1,-1,1),this.cylinder.add(m);var y=this.createDiscMesh(n);y.position.set(0,a/2+M,0),this.cylinder.add(y);var g=y.clone();g.position.set(0,-a/2,0),g.scale.set(1,-1,1),this.cylinder.add(g);var w=new I;w.color.set(new X(.4,.4,.4)),v.material=w,m.material=w,y.material=w,g.material=w,this.scene.add(this.cylinder);var u=new q,l=u.addFolder("Controls");l.open();var D=l.add(this,"crushAlpha",0,1);D.name("Crush Alpha"),D.onChange(C=>{this.morphCylinder()});var Y=l.add(this,"lightOrbitX",-180,180);Y.name("Light Orbit X"),Y.onChange(C=>{this.updateLightParameters()});var O=l.add(this,"lightOrbitY",-90,90);O.name("Light Orbit Y"),O.onChange(C=>{this.updateLightParameters()});var O=l.add(this,"lightIntensity",0,2);O.name("Light Intensity"),O.onChange(C=>{this.updateLightParameters()});var A=l.add(this,"debugMode");A.name("Debug Mode"),A.onChange(C=>{this.toggleDebugMode(C)})}createCrushableCylinderMesh(e,t,o){var i=[],r=[],d=[],n=360/e*Math.PI/180,s=o/t;for(let u=0;u<=t;u++)for(let l=0;l<=e;l++){var a=l*n,c=-o/2+u*s,M=new p(Math.cos(a),c,Math.sin(a)),v=new p(Math.cos(a+n),c,Math.sin(a+n));this.cylinderVertices.push(M),this.cylinderVertices.push(v);var m=Math.abs(Math.cos(u/t*Math.PI));m=$.clamp(m,.25,1),this.crushedCylinderVertices.push(new p(M.x*m,M.y,M.z*m)),this.crushedCylinderVertices.push(new p(v.x*m,v.y,v.z*m)),i.push(Math.cos(a),0,Math.sin(a)),i.push(Math.cos(a+n),0,Math.sin(a+n)),r.push(1-l/e,u/t),r.push(1-(l+1)/e,u/t)}for(let u=0;u<=t;u++)for(let l=0;l<=e;l++){var y=(u*e+l)*2,g=y+e*2;d.push(y,g+1,y+1),d.push(y,g,g+1)}var w=new f;return w.geometry.setFromPoints(this.cylinderVertices),w.geometry.setIndex(d),w.geometry.setAttribute("normal",new L(i,3)),w.geometry.setAttribute("uv",new L(r,2)),w}createCylinderMesh(e,t){var o=[],i=[],r=[],d=[],n=360/e*Math.PI/180;for(let c=0;c<e;c++){var s=c*n;o.push(new p(Math.cos(s),t/2,Math.sin(s))),o.push(new p(Math.cos(s),-t/2,Math.sin(s))),o.push(new p(Math.cos(s+n),t/2,Math.sin(s+n))),o.push(new p(Math.cos(s+n),-t/2,Math.sin(s+n))),i.push(Math.cos(s),0,Math.sin(s)),i.push(Math.cos(s),0,Math.sin(s)),i.push(Math.cos(s+n),0,Math.sin(s+n)),i.push(Math.cos(s+n),0,Math.sin(s+n)),r.push(1-c/e,1),r.push(1-c/e,0),r.push(1-(c+1)/e,1),r.push(1-(c+1)/e,0),d.push(c*4,c*4+2,c*4+1),d.push(c*4+1,c*4+2,c*4+3)}var a=new f;return a.geometry.setFromPoints(o),a.geometry.setIndex(d),a.geometry.setAttribute("normal",new L(i,3)),a.geometry.setAttribute("uv",new L(r,2)),a}createDiscMesh(e){var s=new f,t=[],o=[],i=[];t.push(new p(0,0,0)),o.push(0,1,0);var r=360/e*Math.PI/180,d=2*Math.PI/r;for(let a=0;a<d;a++){var n=a*r;t.push(new p(Math.cos(n),0,Math.sin(n))),t.push(new p(Math.cos(n+r),0,Math.sin(n+r))),o.push(0,1,0),o.push(0,1,0),i.push(0,a*2+2,a*2+1)}var s=new f;return s.geometry.setFromPoints(t),s.geometry.setIndex(i),s.geometry.setAttribute("normal",new L(o,3)),s}morphCylinder(){for(var e=[],t=0;t<this.cylinderVertices.length;t++){var o=new p;o.lerpVectors(this.cylinderVertices[t],this.crushedCylinderVertices[t],this.crushAlpha),e.push(o)}this.cylinderMesh.geometry.setFromPoints(e)}update(e){}onMouseDown(e){e.target.localName=="canvas"&&(this.mouseDrag=!0)}onMouseUp(e){this.mouseDrag=!1}onMouseMove(e){this.mouseDrag&&(this.cameraOrbitX+=e.movementY,this.cameraOrbitX<90||this.cameraOrbitX>270?this.cameraOrbitY+=e.movementX:this.cameraOrbitY-=e.movementX,this.cameraOrbitX>=360?this.cameraOrbitX-=360:this.cameraOrbitX<0&&(this.cameraOrbitX+=360),this.cameraOrbitY>=360?this.cameraOrbitY-=360:this.cameraOrbitY<0&&(this.cameraOrbitY+=360),this.updateCameraOrbit())}updateCameraOrbit(){var e=new P().makeRotationY(-this.cameraOrbitY*Math.PI/180);e.multiply(new P().makeRotationX(-this.cameraOrbitX*Math.PI/180)),this.camera.position.set(0,0,this.cameraDistance),this.camera.applyMatrix4(e),this.cameraOrbitX<90||this.cameraOrbitX>270?this.camera.up.set(0,1,0):this.cameraOrbitX>90&&this.cameraOrbitX<270?this.camera.up.set(0,-1,0):this.cameraOrbitX==270?this.camera.up.set(Math.sin(-this.cameraOrbitY*Math.PI/180),0,Math.cos(-this.cameraOrbitY*Math.PI/180)):this.camera.up.set(-Math.sin(-this.cameraOrbitY*Math.PI/180),0,-Math.cos(-this.cameraOrbitY*Math.PI/180)),this.camera.lookAt(0,0,0)}updateLightParameters(){var e=new P().makeRotationY(this.lightOrbitX*Math.PI/180);e.multiply(new P().makeRotationX(-this.lightOrbitY*Math.PI/180)),this.light.position.set(0,0,10),this.light.applyMatrix4(e),this.lightHelper.lookAt(this.light.position),this.light.intensity=this.lightIntensity}toggleDebugMode(e){this.cylinder.children.forEach(t=>{t instanceof f&&(e?(t.userData={originalMaterial:t.material},t.material=this.debugMaterial):t.material=t.userData.originalMaterial)})}}var S=new Z;S.start();
