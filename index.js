var H=Object.defineProperty;var k=(b,t,e)=>t in b?H(b,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):b[t]=e;var n=(b,t,e)=>(k(b,typeof t!="symbol"?t+"":t,e),e);import{W as R,S as x,P as z,C as F,V as E,M as A,D as W,L as U,G as B,a as O,A as G,b as V,c as K,B as N,d as T,e as _,f as I,T as j,g as q,h as S,i as m,F as X,j as D}from"./vendor.js";const $=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))h(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&h(l)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function h(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}};$();class J{constructor(t=1.333){n(this,"aspectRatio");n(this,"fov");n(this,"znear");n(this,"zfar");n(this,"renderer");n(this,"scene");n(this,"camera");n(this,"clock");this.aspectRatio=t,this.fov=60,this.znear=1,this.zfar=1e3,this.renderer=new R,this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),this.resize(),window.addEventListener("resize",()=>{this.resize()},!1),window.addEventListener("mousedown",e=>{this.onMouseDown(e)}),window.addEventListener("mouseup",e=>{this.onMouseUp(e)}),window.addEventListener("mousemove",e=>{this.onMouseMove(e)}),window.addEventListener("keydown",e=>{this.onKeyDown(e)}),window.addEventListener("keyup",e=>{this.onKeyUp(e)}),this.scene=new x,this.camera=new z(this.fov,this.aspectRatio,this.znear,this.zfar),this.clock=new F}start(){this.createScene(),this.mainLoop()}mainLoop(){this.update(this.clock.getDelta()),this.renderer.render(this.scene,this.camera),window.requestAnimationFrame(()=>this.mainLoop())}resize(){this.renderer.setSize(window.innerWidth,window.innerHeight);var t=new E;this.renderer.getViewport(t);var e=window.innerWidth/window.innerHeight;this.aspectRatio>e?this.renderer.setViewport(0,(window.innerHeight-window.innerWidth/this.aspectRatio)/2,window.innerWidth,window.innerWidth/this.aspectRatio):this.renderer.setViewport((window.innerWidth-window.innerHeight*this.aspectRatio)/2,0,window.innerHeight*this.aspectRatio,window.innerHeight)}onMouseDown(t){}onMouseUp(t){}onMouseMove(t){}onKeyDown(t){}onKeyUp(t){}}class Q extends J{constructor(){super(1920/1080);n(this,"debugMode");n(this,"mouseDrag");n(this,"crushAlpha");n(this,"cameraOrbitX");n(this,"cameraOrbitY");n(this,"cameraDistance");n(this,"lightOrbitX");n(this,"lightOrbitY");n(this,"lightIntensity");n(this,"debugMaterial");n(this,"light");n(this,"lightHelper");n(this,"cylinder");n(this,"cylinderMesh");n(this,"cylinderVertices");n(this,"crushedCylinderVertices");this.debugMode=!1,this.mouseDrag=!1,this.crushAlpha=0,this.cameraOrbitX=0,this.cameraOrbitY=0,this.cameraDistance=0,this.lightOrbitX=0,this.lightOrbitY=0,this.lightIntensity=0,this.debugMaterial=new A,this.light=new W,this.lightHelper=new U,this.cylinder=new B,this.cylinderMesh=new O,this.cylinderVertices=[],this.crushedCylinderVertices=[]}createScene(){this.cameraDistance=4,this.camera.position.set(0,0,this.cameraDistance),this.camera.lookAt(0,0,0),this.camera.up.set(0,1,0);var t=new G("white",.3);this.scene.add(t),this.light.color=new V("white"),this.lightIntensity=1,this.lightOrbitX=-22.5,this.lightOrbitY=45,this.scene.add(this.light);var e=[];e.push(new m(0,0,0)),e.push(new m(0,0,10)),this.lightHelper.geometry.setFromPoints(e),this.scene.add(this.lightHelper);var h=new K;h.color=new V("gray"),this.lightHelper.material=h,this.updateLightParameters();var r=new A;r.side=N,r.color.set("black");var s=new O(new T(1e3,1e3,1e3),r);this.scene.add(s),this.debugMaterial.wireframe=!0;var l=new _(2);this.scene.add(l);const o=20,c=20,i=2.5,d=.05;this.cylinderMesh=this.createCrushableCylinderMesh(o,c,i),this.cylinder.add(this.cylinderMesh);var a=new I;a.map=new j().load("./assets/campbells.png"),this.cylinderMesh.material=a;var f=this.createCylinderMesh(o,d);f.position.set(0,i/2+d/2,0),this.cylinder.add(f);var y=f.clone();y.position.set(0,-i/2+-d/2,0),y.scale.set(1,-1,1),this.cylinder.add(y);var g=this.createDiscMesh(o);g.position.set(0,i/2+d,0),this.cylinder.add(g);var M=g.clone();M.position.set(0,-i/2,0),M.scale.set(1,-1,1),this.cylinder.add(M);var v=new I;v.color.set(new V(.4,.4,.4)),f.material=v,y.material=v,g.material=v,M.material=v,this.scene.add(this.cylinder);var C=new q,p=C.addFolder("Controls");p.open();var u=p.add(this,"crushAlpha",0,1);u.name("Crush Alpha"),u.onChange(P=>{this.morphCylinder()});var w=p.add(this,"lightOrbitX",-180,180);w.name("Light Orbit X"),w.onChange(P=>{this.updateLightParameters()});var L=p.add(this,"lightOrbitY",-90,90);L.name("Light Orbit Y"),L.onChange(P=>{this.updateLightParameters()});var L=p.add(this,"lightIntensity",0,2);L.name("Light Intensity"),L.onChange(P=>{this.updateLightParameters()});var Y=p.add(this,"debugMode");Y.name("Debug Mode"),Y.onChange(P=>{this.toggleDebugMode(P)})}createCrushableCylinderMesh(t,e,h){var r=[],s=[],l=[],o=t+1,c=e+1,i=360/o*Math.PI/180,d=h/e;for(let u=0;u<c;u++)for(let w=0;w<o;w++){var a=w*i,f=-h/2+u*d,y=new m(Math.cos(a),f,Math.sin(a)),g=new m(Math.cos(a+i),f,Math.sin(a+i));this.cylinderVertices.push(y),this.cylinderVertices.push(g);var M=Math.abs(Math.cos(u/e*Math.PI));M=S.clamp(M,.25,1),this.crushedCylinderVertices.push(new m(y.x*M,y.y,y.z*M)),this.crushedCylinderVertices.push(new m(g.x*M,g.y,g.z*M)),r.push(Math.cos(a),0,Math.sin(a)),r.push(Math.cos(a+i),0,Math.sin(a+i)),s.push(1-w/o,(u+1)/c),s.push(1-(w+1)/o,(u+1)/c)}for(let u=0;u<e;u++)for(let w=0;w<o;w++){var v=(u*o+w)*2,C=v+o*2;l.push(v,C+1,v+1),l.push(v,C,C+1)}var p=new O;return p.geometry.setFromPoints(this.cylinderVertices),p.geometry.setIndex(l),p.geometry.setAttribute("normal",new X(r,3)),p.geometry.setAttribute("uv",new X(s,2)),p}createCylinderMesh(t,e){var h=[],r=[],s=[],l=[],o=t+1,c=360/o*Math.PI/180;for(let a=0;a<o;a++){var i=a*c;h.push(new m(Math.cos(i),e/2,Math.sin(i))),h.push(new m(Math.cos(i),-e/2,Math.sin(i))),h.push(new m(Math.cos(i+c),e/2,Math.sin(i+c))),h.push(new m(Math.cos(i+c),-e/2,Math.sin(i+c))),r.push(Math.cos(i),0,Math.sin(i)),r.push(Math.cos(i),0,Math.sin(i)),r.push(Math.cos(i+c),0,Math.sin(i+c)),r.push(Math.cos(i+c),0,Math.sin(i+c)),s.push(1-a/o,1),s.push(1-a/o,0),s.push(1-(a+1)/o,1),s.push(1-(a+1)/o,0),l.push(a*4,a*4+2,a*4+1),l.push(a*4+1,a*4+2,a*4+3)}var d=new O;return d.geometry.setFromPoints(h),d.geometry.setIndex(l),d.geometry.setAttribute("normal",new X(r,3)),d.geometry.setAttribute("uv",new X(s,2)),d}createDiscMesh(t){var i=new O,e=[],h=[],r=[];e.push(new m(0,0,0)),h.push(0,1,0);var s=t+1,l=360/s*Math.PI/180,o=2*Math.PI/l;for(let d=0;d<o;d++){var c=d*l;e.push(new m(Math.cos(c),0,Math.sin(c))),e.push(new m(Math.cos(c+l),0,Math.sin(c+l))),h.push(0,1,0),h.push(0,1,0),r.push(0,d*2+2,d*2+1)}var i=new O;return i.geometry.setFromPoints(e),i.geometry.setIndex(r),i.geometry.setAttribute("normal",new X(h,3)),i}morphCylinder(){for(var t=[],e=0;e<this.cylinderVertices.length;e++){var h=new m;h.lerpVectors(this.cylinderVertices[e],this.crushedCylinderVertices[e],this.crushAlpha),t.push(h)}this.cylinderMesh.geometry.setFromPoints(t)}update(t){}onMouseDown(t){t.target.localName=="canvas"&&(this.mouseDrag=!0)}onMouseUp(t){this.mouseDrag=!1}onMouseMove(t){this.mouseDrag&&(this.cameraOrbitX+=t.movementY,this.cameraOrbitX<90||this.cameraOrbitX>270?this.cameraOrbitY+=t.movementX:this.cameraOrbitY-=t.movementX,this.cameraOrbitX>=360?this.cameraOrbitX-=360:this.cameraOrbitX<0&&(this.cameraOrbitX+=360),this.cameraOrbitY>=360?this.cameraOrbitY-=360:this.cameraOrbitY<0&&(this.cameraOrbitY+=360),this.updateCameraOrbit())}updateCameraOrbit(){var t=new D().makeRotationY(-this.cameraOrbitY*Math.PI/180);t.multiply(new D().makeRotationX(-this.cameraOrbitX*Math.PI/180)),this.camera.position.set(0,0,this.cameraDistance),this.camera.applyMatrix4(t),this.cameraOrbitX<90||this.cameraOrbitX>270?this.camera.up.set(0,1,0):this.cameraOrbitX>90&&this.cameraOrbitX<270?this.camera.up.set(0,-1,0):this.cameraOrbitX==270?this.camera.up.set(Math.sin(-this.cameraOrbitY*Math.PI/180),0,Math.cos(-this.cameraOrbitY*Math.PI/180)):this.camera.up.set(-Math.sin(-this.cameraOrbitY*Math.PI/180),0,-Math.cos(-this.cameraOrbitY*Math.PI/180)),this.camera.lookAt(0,0,0)}updateLightParameters(){var t=new D().makeRotationY(this.lightOrbitX*Math.PI/180);t.multiply(new D().makeRotationX(-this.lightOrbitY*Math.PI/180)),this.light.position.set(0,0,10),this.light.applyMatrix4(t),this.lightHelper.lookAt(this.light.position),this.light.intensity=this.lightIntensity}toggleDebugMode(t){this.cylinder.children.forEach(e=>{e instanceof O&&(t?(e.userData={originalMaterial:e.material},e.material=this.debugMaterial):e.material=e.userData.originalMaterial)})}}var Z=new Q;Z.start();
